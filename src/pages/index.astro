---
import BaseLayout from '../layouts/BaseLayout.astro';
import SubscribeForm from '../components/SubscribeForm.astro';
import { getCollection } from 'astro:content';

const issues = await getCollection('issues');
const latestIssues = issues
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, 5);

const formatDate = (date: Date) => {
  return date.toLocaleDateString('ro-RO', { day: 'numeric', month: 'short' });
};
---

<BaseLayout title="Vești Bune pentru România">
  <!-- Hero Section -->
  <section class="py-24 md:py-32">
    <div class="max-w-3xl mx-auto px-4 text-center">
      <p class="text-xs uppercase tracking-wide text-neutral-500 mb-6">
        Newsletter de vești bune, no doomscrolling
      </p>
      
      <h1 class="font-serif text-display text-charcoal mb-6">
        Începe săptămâna cu vești bune, nu cu anxietate
      </h1>
      
      <p class="text-body-lg text-neutral-600 max-w-xl mx-auto mb-10">
        Good Brief scanează surse de încredere ca Biziday, Europa FM și Europa Liberă, filtrează zgomotul cu AI și îți trimite doar veștile bune. 5 minute de lectură, carefully curated, direct în inbox.
      </p>
      
      <SubscribeForm showHeading={false} class="mb-6" />
      
      {latestIssues.length > 0 && (
        <a 
          href={`/issues/${latestIssues[0].id}`}
          class="inline-flex items-center text-sm text-olive-600 hover:text-olive-700 transition-colors"
        >
          Citește ultima ediție
          <span class="ml-1">→</span>
        </a>
      )}
    </div>
  </section>

  <!-- What You Get Section -->
  <section class="py-16 md:py-24 border-t border-neutral-200">
    <div class="max-w-3xl mx-auto px-4">
      <h2 class="font-serif text-headline text-charcoal mb-12 text-center">
        Ce primești?
      </h2>
      
      <div class="space-y-0 divide-y divide-neutral-200">
        <p class="py-5 text-body-lg text-neutral-700 text-center">
          5 minute de lectură care îți schimbă vibe-ul de luni
        </p>
        <p class="py-5 text-body-lg text-neutral-700 text-center">
          Povești scurte despre oameni care fac bine, nu doar vorbe
        </p>
        <p class="py-5 text-body-lg text-neutral-700 text-center">
          Proiecte și inițiative locale care chiar merită un share
        </p>
        <p class="py-5 text-body-lg text-neutral-700 text-center">
          În fiecare luni dimineața, direct în inbox – one email, feel-good only
        </p>
      </div>
    </div>
  </section>

  <!-- Latest Issues -->
  {latestIssues.length > 0 && (
    <section class="py-16 md:py-24 border-t border-neutral-200">
      <div class="max-w-3xl mx-auto px-4">
        <h2 class="font-serif text-headline text-charcoal mb-12 text-center">
          Ultimele ediții
        </h2>
        
        <div class="divide-y divide-neutral-200">
          {latestIssues.map((issue) => (
            <a 
              href={`/issues/${issue.id}`}
              class="group flex items-center justify-between py-5 hover:bg-neutral-50 -mx-4 px-4 transition-colors"
            >
              <div class="flex items-center gap-6">
                <time class="text-sm text-neutral-500 w-16 shrink-0">
                  {formatDate(issue.data.date)}
                </time>
                <span class="text-charcoal group-hover:text-olive-600 transition-colors">
                  {issue.data.title}
                </span>
              </div>
              <span class="text-neutral-400 group-hover:text-olive-600 transition-colors">
                →
              </span>
            </a>
          ))}
        </div>
        
        <div class="text-center mt-10">
          <a 
            href="/issues" 
            class="text-sm text-olive-600 hover:text-olive-700 transition-colors"
          >
            Vezi toate edițiile din arhivă →
          </a>
        </div>
      </div>
    </section>
  )}

  <!-- Subscribe Section -->
  <div id="subscribe">
    <SubscribeForm class="py-20 md:py-28" />
  </div>
</BaseLayout>
